<!DOCTYPE html>
<html>
  <head>
    <title>QnA Application</title>
    <!-- Add Bootstrap CSS -->
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
      integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z"
      crossorigin="anonymous"
    />
    <!-- Add custom CSS styles -->
    <style>
      body {
        padding: 20px;
      }
      #answer {
        font-size: 1.2em;
      }
      #answer-text {
        font-weight: normal;
      }
      #answer .card-body {
        min-height: 70px;
      }
    </style>
  </head>
  <!-- visible content of the webpage -->
  <body>
    <!-- all content wrapped in a container -->
    <div class="container">
      <h1>Question Answering using Transformers</h1>
      <p>
        Answer questions based on a reference text passage using Google-BERT or
        the transformer we trained from scratch.
      </p>
      <!-- form included to allow users to input their question, reference text(passage) and choose the transformer model to use  -->
      <!-- Form to input the question, reference text, and model name -->
      <form id="form">
        <div class="form-group">
          <label for="question">Question : </label>
          <input
            type="text"
            class="form-control"
            id="question"
            placeholder="Enter question"
          />
        </div>
        <div class="form-group">
          <label for="reference">Enter the passage / reference text : </label>
          <textarea
            class="form-control"
            id="reference"
            placeholder="Enter reference text"
          ></textarea>
        </div>
        <div class="form-group">
          <label for="model_name">Choose Transformer Model to use :</label>
          <input
            type="text"
            class="form-control"
            id="model_name"
            placeholder="Choose between BERT or Major Project"
            value=""
          />
        </div>
        <!-- submit button -->
        <button type="submit" class="btn btn-primary">SUBMIT</button>
        <p></p>
      </form>

      <!-- div for answer to display answer obtained from transformer model -->
      <!-- initially empty and later populated dynamically  -->
      <div id="answer" class="mt-3">
        <div class="card">
          <div class="card-header">Answer :</div>
          <div class="card-body">
            <p id="answer-text" class="card-text"></p>
          </div>
        </div>
      </div>
      <!-- Add jQuery and Bootstrap JS -->
      <!-- JS section -> JS code to handle form submission via AJAX -->
      <!-- uses JQuery to simplify DOM manipulation and handle AJAX requests  -->
      <script
        src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
        integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
        crossorigin="anonymous"
      ></script>
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
      <script
        src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"
        integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV"
        crossorigin="anonymous"
      ></script>
      <!-- Add Typed.js library -->
      <script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.11"></script>
      <script>
        // when the form is submitted, it prevents the default form submission behavior 
        // Submit the form using AJAX
        $("#form").submit(function (event) {
          // Prevent the form from being submitted
          event.preventDefault(); // or use 'return false;'

          $("#answer-text").empty();
          
          // retrieves the values of question, reference text, model name 
          // Get the values of the form fields
          var question = $("#question").val();
          var reference = $("#reference").val();
          var model_name = $("#model_name").val();

          // sends an AJAX post request to server with this data 
          // Make the AJAX request
          $.ajax({
            url: "/",
            type: "POST",
            data: {
              question: question,
              reference: reference,
              model_name: model_name,
            },
            // upon receiving successful response, it extracts the answer and displays it using a typing animation
            success: function (response) {
              // Get the answer from the response
              var answer = response["answer"];

              // After the loading animation is hidden, type the answer using Typed.js
              setTimeout(function () {
                var typed = new Typed("#answer-text", {
                  strings: [answer],
                  typeSpeed: 40,
                  backSpeed: 20,
                  showCursor: false,
                });
              }, 1000);
            },
          });
        });
      </script>
    </div>
  </body>
</html>